# π“¦ 6.4 μΊμ‹ λ©”λ¨λ¦¬ (Cache Memories)

μΊμ‹ λ©”λ¨λ¦¬λ” CPUμ™€ λ©”μΈ λ©”λ¨λ¦¬(λλ” λ³΄μ΅° κΈ°μ–µ μ¥μΉ) μ‚¬μ΄μ— μ„μΉν•μ—¬, μμ£Ό μ ‘κ·Όν•λ” λ°μ΄ν„°λ¥Ό μ„μ‹λ΅ μ €μ¥ν•΄λ‘λ” μ €μ¥ μ¥μΉλ‹¤.  
CPUκ°€ λ°μ΄ν„°λ¥Ό μ”μ²­ν•  λ•, ν•΄λ‹Ή λ°μ΄ν„°κ°€ μΊμ‹μ— μμΌλ©΄ μ΄λ¥Ό λ°”λ΅ μ „λ‹¬ν•μ—¬ μ ‘κ·Ό μ‹κ°„μ„ μ¤„μΌ μ μλ‹¤.

---

## 6.4.1 κΈ°λ³Έ μΊμ‹ λ©”λ¨λ¦¬ κµ¬μ΅° (Generic Cache Memory Organization)

### Cache Block

μΊμ‹ λ©”λ¨λ¦¬λ” λ°μ΄ν„°λ¥Ό **μΊμ‹ λΈ”λ΅(Cache Block)** λ‹¨μ„λ΅ μ €μ¥ν•λ‹¤.  
κ° λΈ”λ΅μ€ λ‹¤μκ³Ό κ°™μ€ κµ¬μ„± μ”μ†λ¥Ό κ°€μ§„λ‹¤:

- **λ°μ΄ν„°(Data)**: μ‹¤μ  λ©”λ¨λ¦¬μ λ‚΄μ©μ„ λ‹΄λ”λ‹¤.  
- **νƒκ·Έ(Tag)**: ν•΄λ‹Ή λΈ”λ΅μ΄ λ©”λ¨λ¦¬μ μ–΄λ μ„μΉλ¥Ό λ‚νƒ€λ‚΄λ”μ§€λ¥Ό μ‹λ³„ν•λ‹¤.  
- **μ ν¨ λΉ„νΈ(Valid Bit)**: ν•΄λ‹Ή λΈ”λ΅μ λ°μ΄ν„°κ°€ μ ν¨ν•μ§€λ¥Ό λ‚νƒ€λ‚Έλ‹¤.

μ ν¨ λΉ„νΈκ°€ 0μ΄λ©΄ ν•΄λ‹Ή μΊμ‹ λΈ”λ΅μ΄ λΉ„μ–΄μκ±°λ‚ μλ»λ λ°μ΄ν„°λ¥Ό κ°€μ§€κ³  μμμ„ μλ―Έν•λ‹¤.

μΊμ‹λ” μ΄ **Sκ°μ μ„ΈνΈ(Set)** λ΅ κµ¬μ„±λκ³ , κ° μ„ΈνΈλ” **Eκ°μ μΊμ‹ λΌμΈ(Line)** λλ” **μ—”νΈλ¦¬(Entry)** λ΅ κµ¬μ„±λλ‹¤.  
κ° μΊμ‹ λΌμΈμ€ ν•λ‚μ μΊμ‹ λΈ”λ΅μ„ λ‹΄λ”λ‹¤.

---

## 6.4.2 μ§μ ‘ λ§¤ν•‘ μΊμ‹ (Direct-Mapped Cache)

μ§μ ‘ λ§¤ν•‘ μΊμ‹λ” κ° μ„ΈνΈμ— μ •ν™•ν ν•λ‚μ μΊμ‹ λΌμΈ(E = 1)λ§ μ΅΄μ¬ν•λ” κµ¬μ΅°λ‹¤.  
κµ¬ν„μ΄ λ‹¨μν•κ³  μ΄ν•΄ν•κΈ° μ‰¬μ΄ νΈμ΄λ‹¤.

![Direct-Mapped Cache](/assets/ch6_mem_hierarchy/cache_structure/directed_map.png)


### λ™μ‘ κ³Όμ •

1. **μ„ΈνΈ μ„ νƒ**  
   μ£Όμ† Aμ—μ„ μ„ΈνΈ μΈλ±μ¤ λΉ„νΈλ¥Ό μ¶”μ¶ν•μ—¬ ν•λ‚μ μ„ΈνΈλ¥Ό μ„ νƒν•λ‹¤.

2. **λΌμΈ λ§¤μΉ­**  
   μ„ νƒλ μ„ΈνΈμ μ ν¨ λΉ„νΈκ°€ 1μ΄κ³ , νƒκ·Έ λΉ„νΈκ°€ μ£Όμ†μ νƒκ·Έμ™€ μΌμΉν•λ©΄ μΊμ‹ ννΈλ‹¤.

3. **μ›λ“ μ¶”μ¶**  
   λΈ”λ΅ μ¤ν”„μ…‹ λΉ„νΈλ¥Ό μ΄μ©ν•΄ μ›ν•λ” λ°μ΄ν„°λ¥Ό μ¶”μ¶ν•λ‹¤.

### λ‹¨μ 

- λ™μΌν• μ„ΈνΈ μΈλ±μ¤λ¥Ό κ°€μ§€λ” μ„λ΅ λ‹¤λ¥Έ μ£Όμ†λ“¤μ΄ **ν•λ‚μ μΊμ‹ λΌμΈμ—λ§ μ €μ¥λ  μ μκΈ° λ•λ¬Έμ—**, μ¶©λμ΄ μ¦μ•„μ§„λ‹¤.
- λ”°λΌμ„ **κ²½ν•© λ―Έμ¤(conflict miss)** κ°€ μμ£Ό λ°μƒν•  μ μλ‹¤.

---

## 6.4.3 μ™„μ „ μ—°κ΄€ μΊμ‹ (Fully Associative Cache)

μ™„μ „ μ—°κ΄€ μΊμ‹λ” **μΊμ‹μ— λ‹¨ ν•λ‚μ μ„ΈνΈλ§ μ΅΄μ¬ν•κ³ **, λ¨λ“  μΊμ‹ λΌμΈμ΄ κ·Έ μ„ΈνΈμ— μ†ν•λ” κµ¬μ΅°λ‹¤.

μ΄ κµ¬μ΅°μ—μ„λ” μ£Όμ†μ **νƒκ·Έ**λ¥Ό λ¨λ“  λΌμΈμ νƒκ·Έμ™€ λΉ„κµν•΄ μΌμΉ μ—¬λ¶€λ¥Ό ν™•μΈν•λ©°, **μ„ΈνΈ μΈλ±μ¤**λ” μ΅΄μ¬ν•μ§€ μ•λ”λ‹¤.

![Direct-Mapped Cache](/assets/ch6_mem_hierarchy/cache_structure/fully_associative.png)

### μ¥μ 

- λ°μ΄ν„°κ°€ μ–΄λ μ„μΉμ—λ‚ μ €μ¥λ  μ μμ–΄, μ μ—°μ„±μ΄ λ§¤μ° λ†’λ‹¤.

### λ‹¨μ 

- λ¨λ“  νƒκ·Έλ¥Ό λ™μ‹μ— λΉ„κµν•΄μ•Ό ν•λ―€λ΅, **ν•λ“μ›¨μ–΄ κµ¬ν„μ΄ λ³µμ΅**ν•κ³  **λΉ„μ©μ΄ λ†’λ‹¤**.

---

## 6.4.4 μ§‘ν•© μ—°κ΄€ μΊμ‹ (Set-Associative Cache)

μ§‘ν•© μ—°κ΄€ μΊμ‹λ” μ§μ ‘ λ§¤ν•‘κ³Ό μ™„μ „ μ—°κ΄€ λ°©μ‹μ μ μ¶©ν• κµ¬μ΅°λ‹¤.  
ν•λ‚μ μ„ΈνΈμ— **2κ° μ΄μƒ(E β‰¥ 2)** μ μΊμ‹ λΌμΈμ΄ μ΅΄μ¬ν•λ‹¤.

μλ¥Ό λ“¤μ–΄, **4-way μ§‘ν•© μ—°κ΄€ μΊμ‹**λ” ν•λ‚μ μ„ΈνΈμ— 4κ°μ λΌμΈμ„ κ°€μ§„λ‹¤.

![Direct-Mapped Cache](/assets/ch6_mem_hierarchy/cache_structure/set_associative.png)

### λ™μ‘ κ³Όμ •

1. **μ„ΈνΈ μ„ νƒ**  
   μ£Όμ†μ—μ„ μ„ΈνΈ μΈλ±μ¤λ¥Ό μ¶”μ¶ν•μ—¬ ν•λ‚μ μ„ΈνΈλ¥Ό μ„ νƒν•λ‹¤.

2. **λΌμΈ λ§¤μΉ­**  
   μ„ νƒλ μ„ΈνΈ λ‚΄μ λΌμΈλ“¤ μ¤‘ μ ν¨ λΉ„νΈκ°€ 1μ΄κ³  νƒκ·Έκ°€ μΌμΉν•λ” λΌμΈμ„ μ°Ύλ”λ‹¤.

3. **μ›λ“ μ¶”μ¶**  
   λΈ”λ΅ μ¤ν”„μ…‹μ„ ν†µν•΄ λ°μ΄ν„°λ¥Ό μ¶”μ¶ν•λ‹¤.

4. **μΊμ‹ λ―Έμ¤ μ‹**  
   - λΉ„μ–΄ μλ” λΌμΈμ΄ μλ‹¤λ©΄ κ±°κΈ°μ— λ°μ΄ν„°λ¥Ό μ €μ¥ν•λ‹¤.  
   - λ¨λ‘ μ‚¬μ© μ¤‘μ΄λΌλ©΄ κµμ²΄ μ •μ±…(LRU, FIFO λ“±)μ— λ”°λΌ ν•λ‚λ¥Ό κµμ²΄ν•λ‹¤.

---

## μΊμ‹ λ§¤ν•‘ λ°©μ‹ λΉ„κµ

| λ§¤ν•‘ λ°©μ‹       | μ„ΈνΈ μ(S) | μ„ΈνΈλ‹Ή λΌμΈ μ(E) | μ¥μ                 | λ‹¨μ                   |
|----------------|------------|-------------------|---------------------|-----------------------|
| μ§μ ‘ λ§¤ν•‘       | λ§μ       | 1                 | κµ¬ν„μ΄ λ‹¨μν•¨       | μ¶©λμ΄ μ¦κ³  μ μ—°μ„± λ¶€μ΅± |
| μ™„μ „ μ—°κ΄€       | 1          | λ§μ              | μ €μ¥ μ„μΉ μμ λ΅μ›€  | ν•λ“μ›¨μ–΄ λ³µμ΅, λλ¦Ό     |
| μ§‘ν•© μ—°κ΄€       | μ¤‘κ°„       | 2 μ΄μƒ            | μ μ—°μ„±κ³Ό ν¨μ¨μ„± μ΅°ν™” | κµ¬ν„μ΄ λ‹¤μ† λ³µμ΅ν•¨     |

---

## μ©μ–΄ μ •λ¦¬

- **μΊμ‹ ννΈ(Cache Hit)**: CPUκ°€ μ”μ²­ν• λ°μ΄ν„°κ°€ μΊμ‹μ— μ΅΄μ¬ν•λ” κ²½μ°
- **μΊμ‹ λ―Έμ¤(Cache Miss)**: μΊμ‹μ— μ—†λ” κ²½μ°
- **νƒκ·Έ(Tag)**: λ©”λ¨λ¦¬ λΈ”λ΅μ μ„μΉλ¥Ό μ‹λ³„ν•λ” μ •λ³΄
- **μ„ΈνΈ μΈλ±μ¤(Set Index)**: μ£Όμ†λ΅λ¶€ν„° μ„ΈνΈλ¥Ό μ„ νƒν•κΈ° μ„ν• λΉ„νΈ
- **λΈ”λ΅ μ¤ν”„μ…‹(Block Offset)**: λΈ”λ΅ λ‚΄μ—μ„ μ›ν•λ” λ°μ΄ν„° μ„μΉλ¥Ό μ°ΎκΈ° μ„ν• λΉ„νΈ
- **κµμ²΄ μ •μ±…(Replacement Policy)**: μΊμ‹κ°€ κ½‰ μ°Όμ„ λ• κµμ²΄ν•  λΈ”λ΅μ„ κ²°μ •ν•λ” κ·μΉ™ (LRU, FIFO λ“±)
